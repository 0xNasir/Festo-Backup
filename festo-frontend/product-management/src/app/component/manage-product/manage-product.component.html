<div class="product-data container-fluid" style="margin-top: 20px;">
  <mat-toolbar style="justify-content: space-between">
    <div class="toolbar-right-content">
      <button matTooltip="Back" mat-flat-button style="background: #f5f5f5;" (click)="location.back()">
        <mat-icon>keyboard_arrow_left</mat-icon>
      </button>
      <span>Product</span>
    </div>
    <div>
      <div *ngIf="!isHandset">
        <button *ngIf="permission.pms.pms_generate_csv && showExporZeroPriceProduct" mat-button (click)="saveAsCSV()">
          Export as CSV
        </button>
        <button *ngIf="showExporZeroPriceProduct" mat-button (click)="router.navigate(['products/zero-price'])">
          Zero-price products
        </button>
        <mat-form-field floatLabel="never" style="max-width: 120px;min-width: 105px;margin-right: 10px;">
          <mat-label>Upcoming</mat-label>
          <mat-select (selectionChange)="FilterByUpcoming(upcoming)" [(ngModel)]="upcoming">
            <mat-option value="0">All</mat-option>
            <mat-option value="1">Upcoming</mat-option>
          </mat-select>
          <mat-error>Please! select a status</mat-error>
        </mat-form-field>
        <mat-form-field floatLabel="never" style="max-width: 120px;min-width: 105px;margin-right: 10px;">
          <mat-label>Stock</mat-label>
          <mat-select (selectionChange)="changeValue(stock)" [(ngModel)]="stock">
            <mat-option value="2">All</mat-option>
            <mat-option value="1">In stock</mat-option>
            <mat-option value="0">Out of stock</mat-option>
          </mat-select>
          <mat-error>Please! select a status</mat-error>
        </mat-form-field>
        <mat-form-field style="min-width: 250px; max-width: 350px;" floatLabel="never">
          <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter">
        </mat-form-field>
        <button *ngIf="permission.pms.pms_create" mat-mini-fab (click)="router.navigate(['product/add'])" matTooltip="Add new product">
          <mat-icon>add</mat-icon>
        </button>
      </div>
      <div *ngIf="isHandset">
        <mat-sidenav-container class="sidenav-container">
          <mat-sidenav #drawer class="sidenav"
                       [ngClass]="{hidden:!(isHandset) === true}"
                       fixedInViewport="true"
                       [attr.role]="'navigation'"
                       [mode]="'over'"
                       [opened]="false" position="end">
            <mat-toolbar><button mat-flat-button (click)="drawer.toggle()">X</button></mat-toolbar>
            <mat-nav-list>
              <div class="list-item">
                <button *ngIf="permission.pms.pms_generate_csv" mat-button (click)="saveAsCSV()" style="width: 100%; text-align: left; border-bottom: 1px solid #000; border-radius: 0; padding-left: 0;">
                  Export as CSV
                </button>
              </div>
              <div class="list-item">
                <button mat-button (click)="router.navigate(['products/zero-price'])" style="width: 100%; text-align: left; border-bottom: 1px solid #000; border-radius: 0; padding-left: 0;">
                  Zero-price products
                </button>
              </div>
              <div class="list-item">
                <mat-form-field floatLabel="never">
                  <mat-label>Upcoming</mat-label>
                  <mat-select (selectionChange)="FilterByUpcoming(upcoming)" [(ngModel)]="upcoming">
                    <mat-option value="0">All</mat-option>
                    <mat-option value="1">Upcoming</mat-option>
                  </mat-select>
                  <mat-error>Please! select a status</mat-error>
                </mat-form-field>
              </div>
              <div class="list-item">
                <mat-form-field floatLabel="never">
                  <mat-label>Stock</mat-label>
                  <mat-select (selectionChange)="changeValue(stock)" [(ngModel)]="stock">
                    <mat-option value="2">All</mat-option>
                    <mat-option value="1">In stock</mat-option>
                    <mat-option value="0">Out of stock</mat-option>
                  </mat-select>
                  <mat-error>Please! select a status</mat-error>
                </mat-form-field>
              </div>
              <div class="list-item">
                <mat-form-field floatLabel="never">
                  <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter">
                </mat-form-field>
              </div>
              <div class="list-item" *ngIf="permission.pms.pms_create">
                <button mat-mini-fab (click)="router.navigate(['product/add'])">
                  <mat-icon>add</mat-icon>
                </button>
              </div>
            </mat-nav-list>
          </mat-sidenav>
          <mat-sidenav-content>
            <mat-toolbar>
              <button
                type="button"
                aria-label="Toggle sidenav"
                mat-icon-button
                (click)="drawer.toggle()"
                *ngIf="isHandset">
                <mat-icon aria-label="Side nav toggle icon">menu</mat-icon>
              </button>
            </mat-toolbar>
          </mat-sidenav-content>
        </mat-sidenav-container>
      </div>
    </div>
  </mat-toolbar>


  <mat-card>
    <mat-card-content>
      <div style="float: right;">
        <span *ngIf="selectedProduct">
          <button mat-icon-button *ngIf="selectedProduct.productDescription.length>50 && selectedProduct.productId==clickedDiv" color="accent" (click)="openProductList(selectedProduct.productDescription)"><i
            class="material-icons">
            fullscreen
          </i></button>
        </span>
        <button mat-flat-button *ngIf="permission.pms.pms_stock_in" [disabled]="!clickedDiv" matTooltip="Stock In" color="primary" (click)="OpenRevisionDialog(selectedProduct, selectedProduct.productName,'in')" style="margin-right: 10px;">Stock In<mat-icon aria-hidden="false" aria-label="eye icon">edit</mat-icon></button>
        <button mat-flat-button *ngIf="permission.pms.pms_stock_out" [disabled]="!clickedDiv" matTooltip="Stock Out" color="primary" (click)="OpenRevisionDialog(selectedProduct, selectedProduct.productName,'out')">Stock Out<mat-icon aria-hidden="false" aria-label="eye icon">edit</mat-icon></button>
        <button mat-flat-button *ngIf="permission.pms.pms_price_log" [disabled]="!clickedDiv" matTooltip="View price logs" color="primary" (click)="OpenRevisionDialog(selectedProduct.productPriceRevision, selectedProduct.productName,'price')" style="margin-left: 10px;">
          Price Log<mat-icon aria-hidden="false" aria-label="eye icon">remove_red_eye</mat-icon>
        </button>
        <button mat-flat-button *ngIf="permission.pms.pms_quantity_log" [disabled]="!clickedDiv" matTooltip="View quantity logs" color="primary" (click)="OpenRevisionDialog(selectedProduct.productQuantityRevision, selectedProduct.productName,'quantity')" style="margin-left: 10px;">
          Quantity Log<mat-icon aria-hidden="false" aria-label="eye icon">remove_red_eye</mat-icon>
        </button>
        <button [disabled]="!clickedDiv" *ngIf="permission.pms.pms_delete" matTooltip="Delete" mat-icon-button color="warn" (click)="deleteProduct(selectedProduct.productId)">
          <mat-icon aria-hidden="false" aria-label="delete icon">delete</mat-icon>
        </button>
        <button [disabled]="!clickedDiv" *ngIf="permission.pms.pms_update" matTooltip="Update" mat-icon-button color="accent" (click)="router.navigate(['product/update/',selectedProduct.productId])">
          <mat-icon aria-hidden="false" aria-label="edit icon">edit</mat-icon>
        </button>
      </div>
      <table mat-table [dataSource]="product" class="mat-elevation-z8 table-responsive" matSort>

        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> ID</th>
          <td mat-cell *matCellDef="let element"> {{element.productId}}</td>
        </ng-container>
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Name</th>
          <td mat-cell *matCellDef="let element"> {{element.productName}}</td>
        </ng-container>

        <!-- Name Column -->
        <ng-container matColumnDef="part">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Part No.</th>
          <td mat-cell *matCellDef="let element"> {{element.productPartNo}}</td>
        </ng-container>
        <ng-container matColumnDef="type">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Type</th>
          <td mat-cell *matCellDef="let element"> {{element.productType}}</td>
        </ng-container>

        <!-- Weight Column -->
        <ng-container matColumnDef="category">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Category</th>
          <td mat-cell *matCellDef="let element"> {{element.productCategory}}</td>
        </ng-container>

        <!-- Symbol Column -->
        <ng-container matColumnDef="description">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Description</th>
          <td mat-cell *matCellDef="let element">
            <span *ngIf="element.productDescription.length>50">
              {{element.productDescription|slice:0:50}}...
            </span>
            <span *ngIf="element.productDescription.length<=50">{{element.productDescription}}</span>
          </td>
        </ng-container>
        <ng-container matColumnDef="price">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Price</th>
          <td mat-cell *matCellDef="let element"> {{MoneyFormat(element.productPrice)}}</td>
        </ng-container>
        <ng-container matColumnDef="stock">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Stock</th>
          <td mat-cell *matCellDef="let element"> {{element.productInStock}}</td>
        </ng-container>
        <ng-container matColumnDef="uuq">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> UUQ</th>
          <td mat-cell *matCellDef="let element"> {{element.productUuq}}</td>
        </ng-container>
        <ng-container matColumnDef="loan">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Loan</th>
          <td mat-cell *matCellDef="let element"> {{element.productLoan}}</td>
        </ng-container>
        <ng-container matColumnDef="booking">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Booking</th>
          <td mat-cell *matCellDef="let element"> {{element.productBooking}}</td>
        </ng-container>
        <ng-container matColumnDef="origin">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Origin</th>
          <td mat-cell *matCellDef="let element"> {{element.productOrigin}}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row style="cursor:pointer;" (click)="selectedRow(row)" [class]="clickedDiv==row.productId?'mat-row ng-star-inserted selected':'mat-row ng-star-inserted'" *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
      <mat-paginator [pageSizeOptions]="[25, 50,100,150,200,500]"></mat-paginator>
    </mat-card-content>
  </mat-card>
</div>
