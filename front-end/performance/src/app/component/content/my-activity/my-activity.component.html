<mat-toolbar style="padding: 0px;">
  <span>
    <button mat-icon-button (click)="location.back()"><mat-icon>keyboard_arrow_left</mat-icon></button>
    <span>My Activities</span>
  </span>
  <span class="fill-remaining-space"></span>
  <span><button mat-mini-fab (click)="openActivityDialog(null,true)"><mat-icon>add</mat-icon></button></span>
</mat-toolbar>
<div *ngIf="!loadedPage" style="width: 100%;margin: 50px 45%;"><mat-spinner></mat-spinner></div>
<div *ngIf="loadedPage">
  <div class="mat-elevation-z8" style="overflow-x: auto;">
    <table mat-table [dataSource]="dataSource">

      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef> No. </th>
        <td mat-cell *matCellDef="let element;let i=index"> {{i+1}} </td>
      </ng-container>
      <ng-container matColumnDef="type">
        <th mat-header-cell *matHeaderCellDef> Type </th>
        <td mat-cell *matCellDef="let element">{{element.activityType}}</td>
      </ng-container>
      <ng-container matColumnDef="company">
        <th mat-header-cell *matHeaderCellDef> Company </th>
        <td mat-cell *matCellDef="let element">
        <span *ngIf="element.activityType=='Visit'">
          <span *ngFor="let v of element.visit">{{v.visitCompany}} <span *ngIf="element.visit.length>1"><br></span></span>
        </span>
          <span *ngIf="element.activityType=='Project in-house development'">{{element.activityCompany}}</span>
          <span *ngIf="element.activityType=='Office work'">-</span>
        </td>
      </ng-container>
      <ng-container matColumnDef="activity">
        <th mat-header-cell *matHeaderCellDef> Activity </th>
        <td mat-cell *matCellDef="let element">
        <span *ngIf="element.activityType=='Visit'">
          <span *ngFor="let visit of element.visit">
            <span *ngFor="let v of visit.visitOutCome;let u=index;">
              <span>{{u+1}}. <span style="margin-left: 10px;">{{v.outCome}}</span><br></span>
            </span>
          </span>
        </span>
          <span *ngIf="element.activityType!='Visit'">
          <span *ngFor="let x of element.activityContent;let u=index;">{{u+1}}. <span style="margin-left: 10px;">{{x.contentDesc}}</span><br></span>
        </span>
        </td>
      </ng-container>
      <ng-container matColumnDef="date">
        <th mat-header-cell *matHeaderCellDef> Date </th>
        <td mat-cell *matCellDef="let element"> {{element.activityDate*1000|date}} </td>
      </ng-container>
      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef> Action </th>
        <td mat-cell *matCellDef="let element">
          <button mat-icon-button color="accent" (click)="deleteActivity(element.activityId)"><mat-icon>delete</mat-icon></button>
          <button mat-icon-button (click)="openActivityDialog(element,false)"><mat-icon>edit</mat-icon></button>
          <button *ngIf="element.activityType=='Visit'" mat-icon-button (click)="openDetailDialog(element)"><mat-icon>remove_red_eye</mat-icon></button>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    <mat-paginator [pageSizeOptions]="[20, 50, 100, 200, 500]" showFirstLastButtons></mat-paginator>
  </div>
</div>

